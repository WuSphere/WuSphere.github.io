<!doctype html><html lang=en><head><meta charset=UTF-8><title></title>
<meta name=viewport content="width=device-width,initial-scale=1"><script src=https://code.jquery.com/jquery-3.6.0.min.js></script></head><body><div id=particles-js></div><main><div class=content><h1>📝</h1><h2 id=shell-scriptファイル一覧と行数をcsvファイルに出力する>[shell script]ファイル一覧と行数をCSVファイルに出力する</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ファイルパスを指定する</span>
</span></span><span style=display:flex><span>filePath<span style=color:#f92672>=</span><span style=color:#e6db74>$&#39;H:/GitLab/fukushisource/fukushisource/SourceFiles/QAA/WebUI&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#行数を定義する（数値）</span>
</span></span><span style=display:flex><span>declare -i filelines<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#出力結果を格納する変数を定義する</span>
</span></span><span style=display:flex><span>declare output<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#改行を定義</span>
</span></span><span style=display:flex><span>LF<span style=color:#f92672>=</span><span style=color:#e6db74>$&#39;\n&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#フォルダを定義</span>
</span></span><span style=display:flex><span>folder<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ファイル名を定義</span>
</span></span><span style=display:flex><span>fileName<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#拡張子を定義</span>
</span></span><span style=display:flex><span>expand<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#フォルダ・ファイルごとに処理する</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> read -r strpath; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#パスがファイルであるかを判定する</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> test -f $strpath;<span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>#ファイル名を取得する</span>
</span></span><span style=display:flex><span>     fileName<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>basename $strpath<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>#拡張子を取得する</span>
</span></span><span style=display:flex><span>     expand<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>strpath##*.<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>#CS・ASPX・XMLファイルの場合のみ後続の処理を行う</span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span>$expand<span style=color:#e6db74>&#34;</span> in 
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;cs&#34;</span> | <span style=color:#e6db74>&#34;aspx&#34;</span> | <span style=color:#e6db74>&#34;xml&#34;</span> |<span style=color:#e6db74>&#34;CS&#34;</span> | <span style=color:#e6db74>&#34;ASPX&#34;</span> | <span style=color:#e6db74>&#34;XML&#34;</span> <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>#対象ファイルの行数を数える</span>
</span></span><span style=display:flex><span>          filelines<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>sed -n <span style=color:#e6db74>&#39;$=&#39;</span> $strpath<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>#count=$(wc -l $strpath)</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>#1回目の場合</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$output<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>;<span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>             output<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$strpath<span style=color:#e6db74>,</span>$folder<span style=color:#e6db74>,</span>$fileName<span style=color:#e6db74>,</span>$filelines<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e>#2回目以降の場合</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>else</span> 
</span></span><span style=display:flex><span>             output<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$output$LF$strpath<span style=color:#e6db74>,</span>$folder<span style=color:#e6db74>,</span>$fileName<span style=color:#e6db74>,</span>$filelines<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>#パスの最後のディレクトリ名を抽出する</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>#folder=`echo ${f} | awk -F &#34;/&#34; &#39;{ print $NF }&#39;`</span>
</span></span><span style=display:flex><span>     folder<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>basename $strpath<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#サブディレクトリを見ない</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#done &lt; &lt;(find ./hoge -mindepth 1 -maxdepth 1)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#サブディレクトリを見る</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span> &lt; &lt;<span style=color:#f92672>(</span>find $filePath -mindepth 1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#出力結果をcsvファイルに書き込み</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$output<span style=color:#e6db74>&#34;</span> &gt; output.csv
</span></span></code></pre></div></div></main></div></div><div id=navigation><a class="nav nav-next" href=/blog/ title=博客文章 style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1741616018></script><script src=/js/perfect-scrollbar.min.js?1741616018></script><script src=/js/perfect-scrollbar.jquery.min.js?1741616018></script><script src=/js/jquery.sticky.js?1741616018></script><script src=/js/featherlight.min.js?1741616018></script><script src=/js/highlight.pack.js?1741616018></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1741616018></script><script src=/js/learn.js?1741616018></script><script src=/js/hugo-learn.js?1741616018></script><script src=/mermaid/mermaid.js?1741616018></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html><script src=https://cdn.jsdelivr.net/npm/particles.js></script><script>document.addEventListener("DOMContentLoaded",function(){particlesJS("particles-js",{particles:{number:{value:100,density:{enable:!0,value_area:800}},shape:{type:"circle"},size:{value:3,random:!0},move:{speed:2},opacity:{value:.5,random:!0},line_linked:{enable:!0,distance:150,color:"#ffffff"}}}),console.log("✅ Particles.js 已初始化！")})</script><style>#particles-js{position:fixed;width:100%;height:100vh!important;top:0;left:0;background:linear-gradient(to right,#000428,#004e92);z-index:-1}main{position:relative;z-index:10;text-align:center;color:#fff;font-family:poppins,sans-serif}</style></body></html>