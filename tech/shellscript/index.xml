<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>shellscript :: WuSphere</title><link>/tech/shellscript/index.html</link><description/><generator>Hugo</generator><language>en-us</language><lastBuildDate>Tue, 18 Mar 2025 23:45:26 +0900</lastBuildDate><atom:link href="/tech/shellscript/index.xml" rel="self" type="application/rss+xml"/><item><title>WindowSä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤</title><link>/tech/shellscript/auto-temp-cleanup-setup/index.html</link><pubDate>Tue, 18 Mar 2025 23:45:26 +0900</pubDate><guid>/tech/shellscript/auto-temp-cleanup-setup/index.html</guid><description>ğŸ› ï¸ ç¬¬ä¸€æ­¥ï¼šç¼–å†™ PowerShell è„šæœ¬ # =============================== # Windows ä¸´æ—¶æ–‡ä»¶æ¸…ç†è„šæœ¬ï¼ˆåŠ å¼ºç‰ˆï¼‰ # =============================== Write-Host "=== ğŸ§¹ å¼€å§‹ç³»ç»Ÿåƒåœ¾æ–‡ä»¶æ¸…ç† ===" # è¦æ¸…ç†çš„è·¯å¾„åˆ—è¡¨ $paths = @( "$env:TEMP", "$env:WINDIR\Temp", "$env:SystemRoot\SoftwareDistribution\Download", "$env:SystemRoot\Prefetch", "$env:LocalAppData\Microsoft\Windows\INetCache", "$env:LocalAppData\Microsoft\Windows\Explorer", "$env:LocalAppData\CrashDumps" ) # åˆ é™¤å‡½æ•°ï¼ˆè‡ªåŠ¨è·³è¿‡è¢«å ç”¨çš„æ–‡ä»¶ï¼‰ function Clear-Folder($path) { if (Test-Path $path) { Write-Host "ğŸ§½ æ¸…ç†ä¸­: $path" try { Get-ChildItem -Path $path -Recurse -Force -ErrorAction SilentlyContinue | ForEach-Object { try { Remove-Item $_.FullName -Recurse -Force -ErrorAction Stop } catch { # Write-Warning "âš ï¸ ç„¡æ³•åˆªé™¤ï¼ˆå¯èƒ½è¢«å ç”¨ï¼‰: $($_.FullName)" } } Write-Host "âœ… å®Œæˆ: $path" } catch { Write-Warning "âŒ ç„¡æ³•æ¸…ç†ï¼ˆæƒé™æˆ–è·¯å¾„é—®é¢˜ï¼‰: $path" } } else { Write-Warning "ğŸ“ è·¯å¾„ä¸å­˜åœ¨: $path" } } # æ‰§è¡Œæ¸…ç† foreach ($path in $paths) { Clear-Folder $path } # å¯é€‰ï¼šæ¸…ç©ºå›æ”¶ç«™ï¼ˆå¦‚éœ€å¯ç”¨ï¼Œè¯·å–æ¶ˆæ³¨é‡Šï¼‰ # Write-Host "ğŸ—‘ æ¸…ç©ºå›æ”¶ç«™..." # (New-Object -ComObject Shell.Application).NameSpace(10).Items() | ForEach-Object { $_.InvokeVerb("delete") } $extraPaths = @( "$env:APPDATA\npm-cache", "$env:APPDATA\npm", "$env:USERPROFILE\.nuget\packages", "$env:APPDATA\Postman", "$env:APPDATA\Code\Cache", "$env:APPDATA\Code\CachedData", "$env:APPDATA\Code\logs", "$env:APPDATA\Code\User\workspaceStorage", "$env:APPDATA\Microsoft\Windows\Recent", "$env:APPDATA\Microsoft\Teams" ) foreach ($extra in $extraPaths) { Clear-Folder $extra } Write-Host "`n=== âœ… æ‰€æœ‰ä¸´æ—¶/ç¼“å­˜æ–‡ä»¶æ¸…ç†å®Œæˆ ===" ğŸ“Œ è¯·å°†è„šæœ¬ä¿å­˜è‡³ï¼šH:\Scripts\Clear-TempFiles.ps1</description></item><item><title>ç’°å¢ƒå¤‰æ•°ä¿®æ­£é–¢é€£</title><link>/tech/shellscript/environmentvariable/index.html</link><pubDate>Tue, 18 Mar 2025 23:45:26 +0900</pubDate><guid>/tech/shellscript/environmentvariable/index.html</guid><description>è³‡æ ¼æƒ…å ±ã‚’æ›´æ–°å¾Œã€å†èµ·å‹•ã®ä»£ã‚ã‚Šã«ã‚­ãƒ£ã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ klist purge ç’°å¢ƒå¤‰æ•°ã‚’ä¿®æ­£ã—ãŸå¾Œã«ã€ç«¯æœ«ã‚’å†èµ·å‹•ã—ãªã„ã§åæ˜ ã™ã‚‹æ–¹æ³• $env:PATH = [System.Environment]::GetEnvironmentVariable("PATH","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("PATH","User")</description></item></channel></rss>