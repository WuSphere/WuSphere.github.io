<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>WindowS一時ファイル削除 :: WuSphere</title><link>/tech/shellscript/auto-temp-cleanup-setup/index.html</link><description>🛠️ 第一步：编写 PowerShell 脚本 # =============================== # Windows 临时文件清理脚本（加强版） # =============================== Write-Host "=== 🧹 开始系统垃圾文件清理 ===" # 要清理的路径列表 $paths = @( "$env:TEMP", "$env:WINDIR\Temp", "$env:SystemRoot\SoftwareDistribution\Download", "$env:SystemRoot\Prefetch", "$env:LocalAppData\Microsoft\Windows\INetCache", "$env:LocalAppData\Microsoft\Windows\Explorer", "$env:LocalAppData\CrashDumps" ) # 删除函数（自动跳过被占用的文件） function Clear-Folder($path) { if (Test-Path $path) { Write-Host "🧽 清理中: $path" try { Get-ChildItem -Path $path -Recurse -Force -ErrorAction SilentlyContinue | ForEach-Object { try { Remove-Item $_.FullName -Recurse -Force -ErrorAction Stop } catch { # Write-Warning "⚠️ 無法刪除（可能被占用）: $($_.FullName)" } } Write-Host "✅ 完成: $path" } catch { Write-Warning "❌ 無法清理（权限或路径问题）: $path" } } else { Write-Warning "📁 路径不存在: $path" } } # 执行清理 foreach ($path in $paths) { Clear-Folder $path } # 可选：清空回收站（如需启用，请取消注释） # Write-Host "🗑 清空回收站..." # (New-Object -ComObject Shell.Application).NameSpace(10).Items() | ForEach-Object { $_.InvokeVerb("delete") } $extraPaths = @( "$env:APPDATA\npm-cache", "$env:APPDATA\npm", "$env:USERPROFILE\.nuget\packages", "$env:APPDATA\Postman", "$env:APPDATA\Code\Cache", "$env:APPDATA\Code\CachedData", "$env:APPDATA\Code\logs", "$env:APPDATA\Code\User\workspaceStorage", "$env:APPDATA\Microsoft\Windows\Recent", "$env:APPDATA\Microsoft\Teams" ) foreach ($extra in $extraPaths) { Clear-Folder $extra } Write-Host "`n=== ✅ 所有临时/缓存文件清理完成 ===" 📌 请将脚本保存至：H:\Scripts\Clear-TempFiles.ps1</description><generator>Hugo</generator><language>en-us</language><lastBuildDate/><atom:link href="/tech/shellscript/auto-temp-cleanup-setup/index.xml" rel="self" type="application/rss+xml"/></channel></rss>